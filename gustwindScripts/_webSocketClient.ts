function i(){let t=document.querySelector('meta[name="pagepath"]');if(!t){console.error("path element was not found!");return}let o=t.getAttribute("content");if(!o){console.log("pagePath was not found in path element");return}return o}function l(t){if(!t){console.error("WebSocket","page path is missing!");return}let o=new WebSocket("ws://localhost:8080");return console.log("WebSocket","connecting"),o.addEventListener("message",a=>{let n,r;try{let e=JSON.parse(a.data);n=e.type,r=e.payload}catch(e){console.error(a,e);return}if(n==="log")console.log("WebSocket",r);else if(n==="refresh")console.log("WebSocket","refreshing"),document.head.innerHTML=r.headMarkup,document.body.innerHTML=r.bodyMarkup,window.createEditor&&window.createEditor();else if(n==="reload")console.log("Websocket","reloading"),o.send(JSON.stringify({type:"reload",payload:{path:t}}));else if(n==="reloadPage")console.log("Websocket","reloading page"),location.reload();else if(n==="replaceScript"){let{name:e}=r,s=document.querySelector(`script[src="${e}"]`)||document.querySelector(`script[data-script="${e}"]`);if(console.log("Websocket","replacing script"),s){s.remove();let c=document.createElement("script");c.setAttribute("src",e+"?cache="+new Date().getTime()),c.setAttribute("type","module"),c.dataset.script=e,document.body.appendChild(c),window.createEditor&&window.createEditor()}}else console.log("WebSocket","unknown event",a)}),o}if(!("Deno"in globalThis)){let t=l(i());window.developmentSocket=t}
