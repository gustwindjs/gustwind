function a(){let t=document.querySelector('meta[property="url"]');if(!t){console.error("url meta field was not found!");return}let o=t.getAttribute("content");if(!o){console.log("valid path was not found in url element");return}return o}function s(t){if(!t){console.error("WebSocket","url is missing!");return}let o=new WebSocket("ws://localhost:8080");return console.log("WebSocket","connecting"),o.addEventListener("message",l=>{let r,n;try{let e=JSON.parse(l.data);r=e.type,n=e.payload}catch(e){console.error(l,e);return}if(r==="log")console.log("WebSocket",n);else if(r==="refresh")console.log("WebSocket","refreshing"),document.head.innerHTML=n.headMarkup,document.body.innerHTML=n.bodyMarkup,window.createEditor&&window.createEditor();else if(r==="reload")console.log("Websocket","reloading"),o.send(JSON.stringify({type:"reload",payload:{path:t}}));else if(r==="reloadPage")console.log("Websocket","reloading page"),location.reload();else if(r==="replaceScript"){let{name:e}=n,i=document.querySelector(`script[src="${e}"]`)||document.querySelector(`script[data-script="${e}"]`);if(console.log("Websocket","replacing script"),i){i.remove();let c=document.createElement("script");c.setAttribute("src",e+"?cache="+new Date().getTime()),c.setAttribute("type","module"),c.dataset.script=e,document.body.appendChild(c),window.createEditor&&window.createEditor()}}else console.log("WebSocket","unknown event",l)}),o}if(!("Deno"in globalThis)){let t=s(a());window.developmentSocket=t}
